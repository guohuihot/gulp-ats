/*!
 * @name modal v1.2
 * @author ahuing
 * @date 2015-12-31 09:03:41
 */
define(function(require,exports,t){function o(){var t,o=document.createElement("div"),s={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(t in s)if(void 0!==o.style[t])return{end:s[t]};return!1}function s(t){return this.each(function(){var o=$(this),s=o.data("jqDrag"),i=$.extend({},n.defaults,o.data(),"object"==typeof t&&t);s||(o.data("jqDrag",s=new n(this,i)),s.init()),"string"==typeof t&&s[t]()})}function i(t,o){return this.each(function(){var s=$(this),i=s.data("jqModal"),e=$.extend({},a.defaults,s.data(),"object"==typeof t&&t);i?"string"==typeof t?i[t](o):i["toggle"]():(s.data("jqModal",i=new a(this,e)),i.init(),i.show(o))})}var e,n,a,d,$=require("$");$.fn.emulateTransitionEnd=function(t){var o,s=!1,i=this;return $(this).one("bsTransitionEnd",function(){s=!0}),o=function(){s||$(i).trigger($.support.transition.end)},setTimeout(o,t),this},$(function(){$.support.transition=o(),$.support.transition&&($.event.special.bsTransitionEnd={bindType:$.support.transition.end,delegateType:$.support.transition.end,handle:function(t){return $(t.target).is(this)?t.handleObj.handler.apply(this,arguments):void 0}})}),e=function(t,o,s){var i=$(s?o||window:"body"),e=$(window).scrollTop(),n=t.outerWidth(),a=t.outerHeight(),d=i.width(),r=i.height();return{minL:n>d?d-n:0,minT:a>r?r-a:0,maxL:n>d?0:i.width()-n,maxT:a>r?0:i.height()-a,st:e,h:a}},n=function(t,o){this.o=$.extend({},n.defaults,o),this.$self=$(t),this.$handle=this.o.handle&&this.$self.find(this.o.handle)||this.$self},n.defaults={handle:"",fixed:1,attachment:""},n.prototype.init=function(){var t=this.o,o=this.$self,s=this.$handle;s.css({cursor:"move"}).on("selectstart",function(){return!1}).on("mousedown",function(s){return o.css({opacity:t.opacity,zIndex:parseInt((new Date).getTime()/1e3)}).trigger("_mousemove",[s.pageX,s.pageY]),!1}).on("_mousemove",function(s,i,n){var a,d,r=e(o,t.attachment,t.fixed),l=o.position(),c=l.left-i,h=l.top-n;o.trigger("dragStart",[r]),$(document).on("mousemove",function(t){t.preventDefault();var s=c+t.pageX,i=h+t.pageY;a=s<r.minL?r.minL:s>r.maxL?r.maxL:s,d=i<r.minT?r.minT:i>r.maxT?r.maxT:i,o.css({left:a,top:d}).trigger("drag",[a,d])}).on("mouseup",function(){$(this).off("mousemove"),o.trigger("dragEnd",[a,d])})})},$.fn.jqDrag=s,a=function(t,o){this.o=o,this.Z=parseInt((new Date).getTime()/1e3),this.$self=$(t),this.isShown=!1},a.defaults={mclass:"",head:"",foot:"",remote:"",fixed:1,overlay:.3,drag:1,lock:0,timeout:0,css:{},headcss:{},bodycss:{},footcss:{},animate:"bounceInDown"},a.prototype={init:function(){var t=this,o=t.o,i=(o.target,'<div class="jqModal animated">                                <div class="m-content m-'+o.mclass+'">                                    <div class="m-head">'+o.head+'</div>                                    <div class="m-body"></div>                                    <div class="m-foot">'+o.foot+'</div>                                    <i class="font-modal-close '+(o.head?"":"dn")+'" data-close="1" title="关闭"></i>                                </div>                            </div>');o.overlay&&(t.$overlay=$('<div class="m-overlay"></div>').appendTo("body").css({opacity:o.overlay,zIndex:t.Z}).on("click",!o.lock&&$.proxy(t.hide,t)||$.noop)),t.$box=$(i).appendTo("body").css($.extend({},o.css,{zIndex:t.Z,position:o.fixed&&"fixed"||"absolute"})).on("click","[data-close]",$.proxy(t.hide,t)),t.$hd=t.$box.find(".m-head").css($.extend({},o.headcss,!o.head&&{display:"none"})),t.$bd=t.$box.find(".m-body").css(o.bodycss),t.$ft=t.$box.find(".m-foot").css($.extend({},o.footcss,!o.foot&&{display:"none"})),t.$self.is("iframe")?t.$self.attr({scrolling:"no",allowtransparency:!0,frameborder:0,src:o.remote}).appendTo(this.$bd).load(function(){t.setPos(1)}):t.$bd.append(t.$self.css("display","block")),o.drag&&(t.$drag=$('<div class="jqModal-drag"></div>').insertAfter(t.$box),t.$hd.on("mousedown",function(s){t.$drag.addClass("jqModal-drag"+o.drag),t.$drag.trigger("_mousemove",[s.pageX,s.pageY])}).css("cursor","move"),$(document).on("mouseup",function(){t.$drag.removeClass("jqModal-drag"+o.drag)}),t.$drag.on(o.drag>1?"dragEnd":"drag",function(o,s,i){t.$box.css({left:s,top:i})}),s.call(t.$drag,{fixed:t.o.fixed})),this.setPos(),$(document).on("keydown.modal",function(o){return 27==o.which&&t.hide(),!0}),o.fixed&&$(window).on("resize",$.proxy(t.setPos,t))},show:function(t){var o=this;o.isShown||(o.$overlay&&o.$overlay.fadeIn(),o.$box.css("display","block"),$.support.transition&&o.$box.addClass(o.o.animate),o.$self.trigger("shownFun"),o.isShown=!0,(t||this.o.timeout)&&(clearTimeout(this.t),this.t=setTimeout($.proxy(this.hide,this),t||this.o.timeout)))},hideModal:function(){this.$box.removeClass(this.o.animate+"H").hide(),this.$overlay&&this.$overlay.hide(),this.$self.trigger("hidenFun")},hide:function(t){return console.log(t),setTimeout($.proxy(function(){this.$box.removeClass(this.o.animate).addClass(this.o.animate+"H"),$.support.transition&&this.$box.one("bsTransitionEnd",$.proxy(this.hideModal,this)).emulateTransitionEnd(500)||this.hideModal()},this),t||0),this.isShown=!1,!1},toggle:function(t){return this.isShown?this.hide(t):this.show()},setSize:function(){this.$self.is("iframe")&&this.$self.add(this.$bd).height(this.$self.css("background","none").contents().find("body").height())},setPos:function(t){t&&this.setSize();var o=this,s=o.o,i=e(o.$box,null,s.fixed);o.fixedT=s.css.bottom>=0?i.maxT-s.css.bottom:s.css.top||($(window).height()-i.h)/2,o.$box.css({left:s.css.right>=0?"auto":s.css.left||i.maxL/2,top:o.fixedT+(!s.fixed&&i.st)}),s.drag&&(o.$drag[0].style.cssText=o.$box[0].style.cssText,o.$drag.css({width:o.$box.width()-6,height:o.$box.height()-6}))}},d=$.fn.jqModal,$.fn.jqModal=i,$.fn.jqModal.Constructor=a,$.fn.jqModal.noConflict=function(){return $.fn.jqModal=d,this},$(document).on("click",".btn-jqModal",function(t){var o,s,e,n=$(this),a=n.data("target")||n.attr("href");"string"==typeof a?(o=0==a.indexOf("http"),s=$(o&&'<iframe class="jqiframe"/>'||a.replace(/.*(?=#[^\s]+$)/,"")),n.data("target",s),e=$.extend({remote:o&&a},s.data(),n.data())):(s=a,e="toggle"),n.is("a")&&t.preventDefault(),i.call(s,e)}),t.exports={tip:function(){var t=$(".jqtip"),o=t[0]&&"show"||{mclass:"tip",animate:"shake",css:{top:150},drag:0,lock:1},s=arguments[2]||1500;t[0]||(t=$('<div class="jqtip"></div>')),t.html('<i class="font-modal-'+arguments[1]+'"></i>'+arguments[0]),i.call(t,o,s)},loading:function(){var t=$(".jqload"),o=t[0]&&"show"||{mclass:"tip",animate:"",drag:0,lock:1};t[0]||(t=$('<div class="jqload"></div>')),arguments[0]?0==arguments[0].search(/(hide|show|toggle)/)?o=arguments[0]:t.html('<i class="font-modal-'+(arguments[1]||"load")+'"></i>'+arguments[0]):t.html('<i class="font-modal-load"></i>loading...'),i.call(t,o)},alert:function(){var t=$(".jqalert"),o=t[0]&&"show"||{head:arguments[2]||"提示信息",css:{width:300},foot:'<button data-close="1" class="ok">确定</button>'};t[0]||(t=$('<div class="jqalert"></div>')),i.call(t.html('<i class="font-modal-'+(arguments[1]||"info")+'"></i>'+arguments[0]),o)},confirm:function(){var t=$(".jqconfirm"),o=t[0]&&"show"||{head:arguments[1]||"提示信息",css:{width:300},foot:'<button data-close="1" class="ok" data-btn="ok">确定</button><button data-close="1" data-btn="no">取消</button>'};t[0]||(t=$('<div class="jqconfirm"></div>')),i.call(t.html('<i class="font-modal-'+(arguments[2]||"ask")+'"></i>'+arguments[0]),o)},lay:function(t){var o=t;$(".jqlay").length?("hide"!=t&&$(".jqlay").html(o),$(".jqlay").jqModal(t)):$('<div class="jqlay">'+o+"</div>").appendTo("body").jqModal()}}});
//# sourceMappingURL=../../../maps/libs/js/plugin/modal.js.map
