/*!
* @name:gallery.js
* @author:ahuing
* @date:2014-01-15
* @modify:2014-01-15
*/
!function($){$.extend(jQuery.easing,{easeOutQuint:function(t,e,n,a,i){return a*((e=e/i-1)*e*e*e*e+1)+n}}),$.extend({gallery:function(t){function e(){return p=h+1,t.circular?p%=f:w.css("display",p==f?"block":"none"),f>p&&a(),!1}function n(){return w.css("display","none"),p=t.circular?(h+f-1)%f:h-1,p>=0&&a(),!1}function a(){var e,n,a=c.css("display","none").find("img").css("display","none").filter(".i"+p),r=l.removeClass(t.curClass).eq(p).addClass(t.curClass);a.length?i(a.css("display","block").data("data-size")):(d.css("display","block"),e=$("<img>",{"class":"i"+p,style:"width:100%;height:100%;"}),n=new Image,n.onerror=function(){i([0,0],e)},n.onload=function(){i(s(n,t.maxW,t.maxH),e)},n.src=r.attr("data-url"),c.prepend(e.attr("src",n.src))),v.attr("href",r.attr("data-url")),g.html(r.attr("data-title")),f>t.visible&&o(),location.hash="#g="+(p+1),t.numerator&&$(t.numerator).text(p+1),h=p,t.endFun&&t.endFun.call(r,p)}function i(e,n){n&&(d.css("display","none"),n.data("data-size",e));var a={left:(t.maxW-e[0])/2,top:(t.maxH-e[1])/2,height:e[1]-b,width:e[0]-b};"css"==t.effect?c.stop(0,1).css(a).animate({opacity:"show"}):c.stop(0,1).animate($.extend(a,{opacity:"show"}))}function s(t,e,n){var a,i,i=_w=t.width,a=_H=t.height;return _w>0&&_H>0&&(_w/_H>=e/n&&_w>e?(i=e,a=parseInt(_H*e/_w)):_H>n&&(a=n,i=parseInt(_w*n/_H))),[i,a]}function o(){var e;m>=p?e=0:p>m&&f-(m+1)>p&&(e=-(p-m)),p>=f-(m+1)&&(e=-(f-t.visible)),r.stop(0,1).animate({left:y*e},400,"easeOutQuint")}var r,l,c,d,u,p,h,f,m,g,v,w,y,b,x,k;t=$.extend({big:"",small:"",botPrev:"",botNext:"",visible:6,curClass:"hover",endLayer:"#endLayer",maxW:500,maxH:400,circular:0,showIndex:0,showBigBot:0,now:1,keyboard:0,oImg:"",title:"",numerator:"",denominator:"",effect:"css",endFun:null},t||{}),$(t.small).length&&(r=$(t.small),l=r.children(),c=$(t.big),d=$('<div class="loading"></div>').insertAfter(c),u=parseInt(location.hash.replace("#g=","")),p=isNaN(u)?t.now-1:u-1,h=0,f=l.length,m=parseInt(t.visible/2)-(t.visible%2==0&&1),g=$(t.title),v=$(t.oImg),w=$(t.endLayer),y=l.outerWidth(!0),b=c.outerWidth()-c.width(),x=c.parent(),l.on("click",function(){return $(this).hasClass(t.curClass)?void 0:(w.css("display","none"),p=l.index(this),a(),!1)}),w.css("display","none").click(function(t){t.stopPropagation()}),t.showIndex&&l.each(function(t){this.innerHTML+="<tt>"+(t+1)+"/"+f+"</tt>"}),t.denominator&&$(t.denominator).text(f),x.css({width:t.maxW,height:t.maxH,position:"relative",margin:"0 auto",cursor:"pointer"}).attr({unselectable:"on",onselectstart:"return false;"}),c.css({position:"absolute",left:"50%",top:"50%",width:0,height:0,overflow:"hidden"}),r.css({left:0,width:99999,position:"relative"}).parent().css({width:y*t.visible,overflow:"hidden",margin:"0 auto",position:"relative"}),a(),t.showBigBot&&($pnBtns=$('<a class="big-prev">&#xe68c;</a><a class="big-next">&#xe68f;</a>').appendTo(x),k=x.offset().left+t.maxW/2,x.mouseenter(function(t){$pnBtns.eq(t.pageX>k).animate({opacity:"show"})}).mousemove(function(t){$pnBtns[1*(t.pageX>k)].style.display="block",$pnBtns[1*(t.pageX<k)].style.display="none"}).mouseleave(function(){$pnBtns.css("display","none")}).click(function(t){t.pageX>k?e():n()})),t.botPrev&&$(t.botPrev).on("click",function(){return n(),!1}),t.botNext&&$(t.botNext).on("click",function(){return e(),!1}),t.keyboard&&$(document).on("keydown",function(t){var a=t.which;return 33==a||37==a?(n(),!1):34==a||39==a?(e(),!1):void 0}))}})}(jQuery);